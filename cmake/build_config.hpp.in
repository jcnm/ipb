#pragma once

/**
 * @file build_config.hpp
 * @brief IPB Build Configuration - Auto-generated by CMake
 *
 * This file contains compile-time configuration based on the selected
 * build mode (SERVER, EDGE, EMBEDDED) and user overrides.
 *
 * DO NOT EDIT THIS FILE MANUALLY - it is generated during CMake configuration.
 */

#include <cstddef>
#include <cstdint>

namespace ipb::common::build {

//=============================================================================
// Build Mode
//=============================================================================

/// Build mode name
inline constexpr const char* BUILD_MODE = "@IPB_BUILD_MODE@";

/// Build mode detection macros (one will be defined)
#cmakedefine IPB_MODE_SERVER
#cmakedefine IPB_MODE_EDGE
#cmakedefine IPB_MODE_EMBEDDED

/// Check if running in server mode
inline constexpr bool is_server_mode() noexcept {
#ifdef IPB_MODE_SERVER
    return true;
#else
    return false;
#endif
}

/// Check if running in edge mode
inline constexpr bool is_edge_mode() noexcept {
#ifdef IPB_MODE_EDGE
    return true;
#else
    return false;
#endif
}

/// Check if running in embedded mode
inline constexpr bool is_embedded_mode() noexcept {
#ifdef IPB_MODE_EMBEDDED
    return true;
#else
    return false;
#endif
}

//=============================================================================
// Performance Configuration
//=============================================================================

/// Default buffer size in bytes
inline constexpr size_t DEFAULT_BUFFER_SIZE = @IPB_BUFFER_SIZE_RESOLVED@;

/// Maximum number of connections
inline constexpr size_t MAX_CONNECTIONS = @IPB_MAX_CONNECTIONS_RESOLVED@;

/// Thread pool size
inline constexpr size_t THREAD_POOL_SIZE = @IPB_THREAD_POOL_SIZE_RESOLVED@;

//=============================================================================
// Feature Flags
//=============================================================================

/// HTTP/2 support enabled
#cmakedefine01 IPB_ENABLE_HTTP2

/// Statistics collection enabled
#cmakedefine01 IPB_ENABLE_STATISTICS

/// Full logging enabled
#cmakedefine01 IPB_ENABLE_FULL_LOGGING

/// MQTT TLS support
#cmakedefine01 IPB_MQTT_TLS

/// HTTP TLS support
#cmakedefine01 IPB_HTTP_TLS

/// WebSocket support
#cmakedefine01 IPB_ENABLE_WEBSOCKET

inline constexpr bool http2_enabled() noexcept {
    return IPB_ENABLE_HTTP2 != 0;
}

inline constexpr bool statistics_enabled() noexcept {
    return IPB_ENABLE_STATISTICS != 0;
}

inline constexpr bool full_logging_enabled() noexcept {
    return IPB_ENABLE_FULL_LOGGING != 0;
}

inline constexpr bool mqtt_tls_enabled() noexcept {
    return IPB_MQTT_TLS != 0;
}

inline constexpr bool http_tls_enabled() noexcept {
    return IPB_HTTP_TLS != 0;
}

inline constexpr bool websocket_enabled() noexcept {
    return IPB_ENABLE_WEBSOCKET != 0;
}

//=============================================================================
// SSL/TLS Backend
//=============================================================================

/// SSL backend name
inline constexpr const char* SSL_BACKEND = "@IPB_SSL_BACKEND_RESOLVED@";

#cmakedefine IPB_SSL_OPENSSL
#cmakedefine IPB_SSL_MBEDTLS
#cmakedefine IPB_SSL_WOLFSSL
#cmakedefine IPB_SSL_NONE

inline constexpr bool ssl_openssl() noexcept {
#ifdef IPB_SSL_OPENSSL
    return true;
#else
    return false;
#endif
}

inline constexpr bool ssl_mbedtls() noexcept {
#ifdef IPB_SSL_MBEDTLS
    return true;
#else
    return false;
#endif
}

inline constexpr bool ssl_wolfssl() noexcept {
#ifdef IPB_SSL_WOLFSSL
    return true;
#else
    return false;
#endif
}

inline constexpr bool ssl_enabled() noexcept {
#ifdef IPB_SSL_NONE
    return false;
#else
    return true;
#endif
}

//=============================================================================
// Backend Names
//=============================================================================

/// HTTP backend name
inline constexpr const char* HTTP_BACKEND = "@IPB_HTTP_BACKEND_RESOLVED@";

/// MQTT backend name
inline constexpr const char* MQTT_BACKEND = "@IPB_MQTT_BACKEND_RESOLVED@";

/// WebSocket backend name
inline constexpr const char* WS_BACKEND = "@IPB_WS_BACKEND_RESOLVED@";

/// JSON backend name
inline constexpr const char* JSON_BACKEND = "@IPB_JSON_BACKEND_RESOLVED@";

/// Protobuf backend name
inline constexpr const char* PROTOBUF_BACKEND = "@IPB_PROTOBUF_BACKEND_RESOLVED@";

//=============================================================================
// Version Information
//=============================================================================

/// IPB version string
inline constexpr const char* IPB_VERSION = "@PROJECT_VERSION@";

/// IPB major version
inline constexpr int IPB_VERSION_MAJOR = @PROJECT_VERSION_MAJOR@;

/// IPB minor version
inline constexpr int IPB_VERSION_MINOR = @PROJECT_VERSION_MINOR@;

/// IPB patch version
inline constexpr int IPB_VERSION_PATCH = @PROJECT_VERSION_PATCH@;

//=============================================================================
// Mode-Specific Defaults (compile-time selection)
//=============================================================================

namespace defaults {

#if defined(IPB_MODE_SERVER)
    inline constexpr size_t QUEUE_CAPACITY = 100000;
    inline constexpr size_t BATCH_SIZE = 1000;
    inline constexpr int SOCKET_BUFFER_SIZE = 1024 * 1024;
    inline constexpr bool ENABLE_COMPRESSION = true;
    inline constexpr bool ENABLE_KEEPALIVE = true;

#elif defined(IPB_MODE_EDGE)
    inline constexpr size_t QUEUE_CAPACITY = 10000;
    inline constexpr size_t BATCH_SIZE = 100;
    inline constexpr int SOCKET_BUFFER_SIZE = 64 * 1024;
    inline constexpr bool ENABLE_COMPRESSION = true;
    inline constexpr bool ENABLE_KEEPALIVE = true;

#elif defined(IPB_MODE_EMBEDDED)
    inline constexpr size_t QUEUE_CAPACITY = 100;
    inline constexpr size_t BATCH_SIZE = 10;
    inline constexpr int SOCKET_BUFFER_SIZE = 4 * 1024;
    inline constexpr bool ENABLE_COMPRESSION = false;
    inline constexpr bool ENABLE_KEEPALIVE = false;

#else
    // Default to edge-like settings
    inline constexpr size_t QUEUE_CAPACITY = 10000;
    inline constexpr size_t BATCH_SIZE = 100;
    inline constexpr int SOCKET_BUFFER_SIZE = 64 * 1024;
    inline constexpr bool ENABLE_COMPRESSION = true;
    inline constexpr bool ENABLE_KEEPALIVE = true;
#endif

} // namespace defaults

} // namespace ipb::common::build
